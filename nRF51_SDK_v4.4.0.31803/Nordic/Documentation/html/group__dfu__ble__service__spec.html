<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DFU Service Specification</title>
<link href="tabs.css" rel="stylesheet" type="text/css" />
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="alias.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="alias.js"></script>
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/javascript">
  jQuery(document).ready(function () {
    if(gref){ // Number all _img and _table classes
      gref();
    }
  });
</script>
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nordic_small.png"></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF51 SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__dfu__ble__service__spec.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DFU Service Specification<div class="ingroups"><a class="el" href="group__dfu__transport__ble.html">BLE</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="ota_spec_sec"></a>
Device Firmware Update Service</h1>
<h2><a class="anchor" id="ota_spec_abstract"></a>
Overview</h2>
<p>Nordic Device Firmware Update (DFU) Service exposes necessary information to perform Device Firmware Update on the device. NOTE: This is not a service defined by the Bluetooth SIG, a proprietary one to demonstrate a typical firmware update on an nRF51 device.</p>
<p>DFU Service does not depend on any other service. Support for following GATT sub-procedures are mandatory for this service: a. Write Characteristic Value b. Notifications c. Read Characteristic Descriptors d. Write Characteristic Descriptors</p>
<p>DFU GATT Service can operate on Bluetooth Low Energy as transport only.</p>
<p>The Service does not define any new error codes for Attribute Protocol and data exchange in is little endian (LSB first) order.</p>
<p>This service is instantiated as a primary service in the DFU mode.</p>
<h2><a class="anchor" id="ota_spec_number"></a>
ota_spec_number</h2>
<p>The Service UUID assigned is value 0x1531 over proprietary base, see table below.</p>
<p>UUID For Nordic:</p>
<table class="doxtable">
<tr>
<th>Description </th><th>Number Base</th></tr>
<tr>
<td>Company Identifier: </td><td>0x0059 </td></tr>
<tr>
<td>UUID Base: </td><td>0x23, 0xD1, 0xBC, 0xEA, 0x5F, 0x78, 0x23, 0x15, 0xDE, 0xEF, 0x12, 0x12, 0x00, 0x00, 0x00, 0x00 </td></tr>
<tr>
<td>Service UUID start: </td><td>0x1530 </td></tr>
<tr>
<td>Characteristic UUID start: </td><td>0x1531 </td></tr>
</table>
<h2><a class="anchor" id="ota_spec_char"></a>
Service Characteristics</h2>
<p>DFU Service exposes one instance of characteristics listed in table below. This service does not impose any security requirements.</p>
<table class="doxtable">
<tr>
<th>Characteristic Name </th><th>Requirement </th><th>Mandatory Properties </th><th>Descriptors </th><th>Description</th></tr>
<tr>
<td>DFU Packet </td><td>M </td><td>WriteWithoutResponse </td><td></td><td>See <a class="el" href="group__dfu__ble__service__spec.html#ota_spec_dfu_packet">DFU Packet</a> </td></tr>
<tr>
<td>DFU Control Point </td><td>M </td><td>Write, Notify </td><td></td><td>See <a class="el" href="group__dfu__ble__service__spec.html#ota_spec_control_state">DFU Control Point</a> </td></tr>
</table>
<h1><a class="anchor" id="ota_spec_dfu_packet"></a>
DFU Packet</h1>
<h2><a class="anchor" id="ota_spec_dfu_packet_number"></a>
UUID: 0x1532 over proprietary base.</h2>
<h2><a class="anchor" id="ota_spec_dfu_packet_summary"></a>
Summary:</h2>
<p>This characteristic receives firmware to nRF51 device as DFU Packets. The firmware is transferred by writing each fragment as DFU Packet to this characteristic. Size of each packet is in range of 1 to (ATT_MTU - 3).</p>
<div class="image">
<img src="dfu_packet.png" alt="dfu_packet.png"/>
<div class="caption">
DFU Packet</div></div>
 <h1><a class="anchor" id="ota_spec_control_state"></a>
DFU Control Point</h1>
<p>All DFU Procedures are requested using this characteristic. A DFU Procedure request is initiated by writing to this characteristic. A Response, marking end of procedure is received as a notification. The Characteristic value or the DFU Control PDU has the following format</p>
<h2><a class="anchor" id="ota_spec_control_point_number"></a>
UUID: 0x1531 over proprietary base.</h2>
<h2><a class="anchor" id="ota_spec_control_point_summary"></a>
Summary:</h2>
<p>The DFU Control Point characteristic is used to control the state of Device Firmware Update process.</p>
<p>Table below summarizes control point procedure op-code and respective parameters.</p>
<div class="image">
<img src="dfu_ctrl_pt.png" alt="dfu_ctrl_pt.png"/>
<div class="caption">
DFU Control Point</div></div>
 <h2><a class="anchor" id="ota_spec_control_point_err_handling"></a>
General Error Handling procedures</h2>
<p>If an Op Code is written to the <em>DFU Control Point</em> characteristic and the Client Characteristic Configuration descriptors of either or both of the <em>DFU Control Point</em> or the <em>DFU Status Report</em> are not configured for notifications, the DFU Target will return an error response with the Attribute Protocol Application error code set to <em>Client Characteristic Configuration Descriptor Improperly Configured</em> as defined in CSS Part B, Section 1.2 of Supplement to the Bluetooth Core Specification, Version 3 or later. </p>
</div><!-- contents -->
</div><!-- doc-content -->

    <li class="footer">
      Copyright &copy 2006-2013 <a href="http://www.nordicsemi.no" style="text-decoration:none">Nordic Semiconductor</a>.
      All Rights Reserved.
      <a href="disclaimer.html">Disclaimer</a>
    </li>
   </ul>
 </div>
</body>
</html>
