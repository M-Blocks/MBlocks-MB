<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF51 SDK - S310 SoftDevice: DFU BLE packet handling in Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF51 SDK - S310 SoftDevice
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00748.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">DFU BLE packet handling in Application<div class="ingroups"><a class="el" href="a00833.html">Bootloader/DFU API</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>DFU BLE packet handling for application.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gacb9c231addcf47494f127d60d875232c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gacb9c231addcf47494f127d60d875232c"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00748.html#gacb9c231addcf47494f127d60d875232c">dfu_app_reset_prepare_t</a> )(void)</td></tr>
<tr class="memdesc:gacb9c231addcf47494f127d60d875232c"><td class="mdescLeft">&#160;</td><td class="mdescRight">DFU Application reset prepare function. This function is a callback which allows the application to prepare for an upcoming application reset. <br/></td></tr>
<tr class="separator:gacb9c231addcf47494f127d60d875232c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga0b5bc3c6d3daca444ec05d33d065f369"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00748.html#ga0b5bc3c6d3daca444ec05d33d065f369">dfu_app_on_dfu_evt</a> (<a class="el" href="a00758.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *p_dfu, <a class="el" href="a00142.html">ble_dfu_evt_t</a> *p_evt)</td></tr>
<tr class="memdesc:ga0b5bc3c6d3daca444ec05d33d065f369"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for handling of <a class="el" href="a00142.html">ble_dfu_evt_t</a> from DFU Service.  <a href="#ga0b5bc3c6d3daca444ec05d33d065f369">More...</a><br/></td></tr>
<tr class="separator:ga0b5bc3c6d3daca444ec05d33d065f369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga46ec5bb0ed70dfa3207ba06a25ce2347"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00748.html#ga46ec5bb0ed70dfa3207ba06a25ce2347">dfu_app_reset_prepare_set</a> (<a class="el" href="a00748.html#gacb9c231addcf47494f127d60d875232c">dfu_app_reset_prepare_t</a> reset_prepare_func)</td></tr>
<tr class="memdesc:ga46ec5bb0ed70dfa3207ba06a25ce2347"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for registering for reset prepare calls.  <a href="#ga46ec5bb0ed70dfa3207ba06a25ce2347">More...</a><br/></td></tr>
<tr class="separator:ga46ec5bb0ed70dfa3207ba06a25ce2347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab1fd97fd650257c8bf02fbffc63baf6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00748.html#gaab1fd97fd650257c8bf02fbffc63baf6">dfu_app_set_dm_handle</a> (<a class="el" href="a00781.html#gaf4616538d9102b901e86d92fc4e82c5c">dm_handle_t</a> const *p_dm_handle)</td></tr>
<tr class="memdesc:gaab1fd97fd650257c8bf02fbffc63baf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for setting Device manager handle for current BLE connection.  <a href="#gaab1fd97fd650257c8bf02fbffc63baf6">More...</a><br/></td></tr>
<tr class="separator:gaab1fd97fd650257c8bf02fbffc63baf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>DFU BLE packet handling for application. </p>
<p>This module implements handling of DFU packets transmitted over BLE for switching from application mode to Bootloader running full DFU service. This module only handles the StartDFU packet allowing for any BLE application to expose support for the DFU service. Actual DFU service will execute in dedicated environment after a BLE disconnect and reset of the nRF51 chip. The host must then reconnect and can continue the update procedure with access to full DFU service.</p>
<dl class="section note"><dt>Note</dt><dd>The application must propagate dfu events to the DFU App handler module by calling <a class="el" href="a00748.html#ga0b5bc3c6d3daca444ec05d33d065f369" title="Function for handling of ble_dfu_evt_t from DFU Service.">dfu_app_on_dfu_evt()</a> from the <a class="el" href="a00758.html#ga4c1ddf1bdd414c49f408f4ffd965fa00">ble_dfu_evt_handler_t</a> callback. </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga0b5bc3c6d3daca444ec05d33d065f369"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dfu_app_on_dfu_evt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00758.html#ga03ad2477271b1db6cdcbf6285b5ccf3f">ble_dfu_t</a> *&#160;</td>
          <td class="paramname"><em>p_dfu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00142.html">ble_dfu_evt_t</a> *&#160;</td>
          <td class="paramname"><em>p_evt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for handling of <a class="el" href="a00142.html">ble_dfu_evt_t</a> from DFU Service. </p>
<p>The application must inject this function into the DFU service or propagate DFU events to dfu_app_handler module by calling this function in application specific DFU event handler.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_dfu</td><td>Pointer to the DFU Service structure for which the include event relates. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_evt</td><td>Pointer to the DFU event. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga46ec5bb0ed70dfa3207ba06a25ce2347"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dfu_app_reset_prepare_set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00748.html#gacb9c231addcf47494f127d60d875232c">dfu_app_reset_prepare_t</a>&#160;</td>
          <td class="paramname"><em>reset_prepare_func</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for registering for reset prepare calls. </p>
<p>The function provided will be executed before reseting the system into Bootloader/DFU mode. By setting this function the caller will be notified prior to the reset and can thus prepare the application for reset. As example the application can gracefully disconnect any peers on BLE, turning of LEDS, ensure all pending flash operations has completed, etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">reset_prepare_func</td><td>Function to be execute prior to a reset. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaab1fd97fd650257c8bf02fbffc63baf6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dfu_app_set_dm_handle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00781.html#gaf4616538d9102b901e86d92fc4e82c5c">dm_handle_t</a> const *&#160;</td>
          <td class="paramname"><em>p_dm_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for setting Device manager handle for current BLE connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_dm_handle</td><td>Pointer to device manager handle of current connection. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Jan 15 2015 09:02:49 for nRF51 SDK - S310 SoftDevice by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
